\documentclass{article}

% if you need to pass options to natbib, use, e.g.:
% \PassOptionsToPackage{numbers, compress}{natbib}
% before loading nips_2017
%
% to avoid loading the natbib package, add option nonatbib:
% \usepackage[nonatbib]{nips_2017}
\PassOptionsToPackage{numbers, compress}{natbib}
\usepackage{nips_2017}

% to compile a camera-ready version, add the [final] option, e.g.:
% \usepackage[final]{nips_2017}

\usepackage[utf8]{inputenc} % allow utf-8 input
\usepackage[T1]{fontenc}    % use 8-bit T1 fonts
\usepackage{hyperref}       % hyperlinks
\usepackage{url}            % simple URL typesetting
\usepackage{booktabs}       % professional-quality tables
\usepackage{amsmath}
\usepackage{amsfonts}       % blackboard math symbols
\usepackage{nicefrac}       % compact symbols for 1/2, etc.
\usepackage{microtype}      % microtypography
\bibliographystyle{unsrtnat}

\title{Bayesian Inference of Plasma Diffusion Parameters: An LSSVM based approach}

% The \author macro works with any number of authors. There are two
% commands used to separate the names and addresses of multiple
% authors: \And and \AND.
%
% Using \And between authors leaves it to LaTeX to determine where to
% break the lines. Using \AND forces a line break at that point. So,
% if LaTeX puts 3 of 4 authors names on the first line, and the last
% on the second line, try using \AND instead of \And before the third
% author name.

\author{
  Mandar H.~Chandorkar\thanks{Use footnote for providing further
    information about author (webpage, alternative
    address)---\emph{not} for acknowledging funding agencies.} \\
  Multiscale Dynamics\\
  Centrum Wiskunde Informatica\\
  Amsterdam 1098XG, the Netherlands\\
  \texttt{mandar.chandorkar@cwi.nl} \\
  %% examples of more authors
  %% \And
  %% Coauthor \\
  %% Affiliation \\
  %% Address \\
  %% \texttt{email} \\
  %% \AND
  %% Coauthor \\
  %% Affiliation \\
  %% Address \\
  %% \texttt{email} \\
  %% \And
  %% Coauthor \\
  %% Affiliation \\
  %% Address \\
  %% \texttt{email} \\
  %% \And
  %% Coauthor \\
  %% Affiliation \\
  %% Address \\
  %% \texttt{email} \\
}

\begin{document}
% \nipsfinalcopy is no longer used

\maketitle

\begin{abstract}
  The abstract paragraph should be indented \nicefrac{1}{2}~inch
  (3~picas) on both the left- and right-hand margins. Use 10~point
  type, with a vertical spacing (leading) of 11~points.  The word
  \textbf{Abstract} must be centered, bold, and in point size 12. Two
  line spaces precede the abstract. The abstract must be limited to
  one paragraph.
\end{abstract}

\section{Introduction}

\section{Methodology}

Bayesian inference involves specifying the following components.
\begin{enumerate}
\item Prior distribution over system parameters.
\item Quantification of likelihood over observations.
\item Procedure for performing inference, i.e. exact inference, \emph{Markov Chain
    Monte Carlo}, \emph{Variational methods}, etc.
\end{enumerate}

Performing Bayesian inference over parameters of physical systems,
involves synthesizing pre-exsiting knowledge of the physical system in
question i.e. the \emph{partial differential equation} (PDE), with
statistical techniques. The aim of such an exercise is often the
quantification of uncertainty over system parameters from an often
sparse set of observations which are quantities of interest in the
physical system. 

\subsection{Inverse Problems}\label{sec:inv}

The \emph{inverse problem} can be stated as follows: given a set of
noisy observations $y$ scattered in the space time domain, of a
physical quantity $f$ governed by the dynamical system
$\mathcal{L}_{\theta} f = Q_{\theta}$, estimate the parameters $\theta$ of the
dynamical system $(\mathcal{L}_{\theta}, Q_{\theta})$.

In this formalism $\mathcal{L}_{\theta}$ is a differential operator,
$Q_{\theta}$ is a \emph{source term} and $\theta$ is a collection of parameters
which specify the operator and the source term.

\subsection{Physical System: Plasma Diffusion}

The radial diffusion system is a simplified one-dimensional version of
the \emph{Fokker-Plank} equation. It tracks the time evolution of the
\emph{phase space density} of particles, $f$ which is goverened by the
differential equation \ref{eq:raddiffusion} known as \emph{radial
  diffusion} \citep{JGRA:JGRA9345}.

\begin{equation}\label{eq:raddiffusion}
  \frac{\partial{f}}{\partial{t}} = l^2 \frac{\partial}{\partial{l}}\left( \frac{\kappa(l,
      t)}{l^{2}} \frac{\partial{f}}{\partial{l}} \right) - \lambda(l,
  t) f +  Q(l, t)
\end{equation}

The \emph{phase space density}, $f$, is a function of the spatial
coordinate $l$ which is also known as the \emph{Roederer} $L^*$ or
\emph{L-shell} in magnetospheric physics \citep{Roederer1970}.

The key quantities in the system above are.

\begin{enumerate}
\item $f$: The density of particles as a function of space $l$ and
  time $t$.
\item $\kappa(l, t)$: Diffusion field.
\item $\lambda(l, t)$: Loss rate, this is a non-negative
  quantity which indicates how quickly particles are lost from the
  radiation belts.
\item $Q(l, t)$: Particle injection rate.
\end{enumerate}

Casting system \ref{eq:raddiffusion} in terms of the terminology of
section \ref{sec:inv}, $\mathcal{L}_{\theta} =
\frac{\partial}{\partial{t}} - l^2 \frac{\partial}{\partial{l}}\left( \frac{\kappa(l,
      t)}{l^{2}} \frac{\partial}{\partial{l}} \right) - \lambda(l,
  t)$. In this case $\theta$ would a collection of parameters which
  would specify the analytic expressions for $\kappa(l,t)$,
  $\lambda(l,t)$ and $Q(l,t)$.

\subsubsection*{Diffusion Parameters}

To solve the radial diffusion system \ref{eq:raddiffusion}, the
quantities $\kappa(l, t)$, $\lambda(l, t)$ and $Q(l, t)$ need to be
specified. It is a common practice (see \citet{GRL:GRL10762},
\citet{JGRA:JGRA15067}, \citet{JGRA:JGRA18021} and
\citet{GRL:GRL22815}) to parameterise the diffusion field
$\kappa$ and loss rate $\lambda$ in the following manner.

\begin{equation}
  \kappa(l,t), \lambda(l, t) \sim \alpha l^{\beta} 10^{b Kp(t)}
\end{equation}

The quantities $\alpha$, $\beta$ and $b$ are parameters which define
the diffusion field and loss rate while the quantity $Kp(t)$ is known
as the Kp index, a measured quantity which stands as a proxy for the
global geomagnetic activity \cite{BartelsKp}.

\subsection{Model Formulation}

We approach the radial diffusion inference problem by formulating a
modified version of the \emph{least squares support vector machine}
predictor for obtaining a closed form approximation to the phase space
density $f$ which tries to satisfy the radial diffusion PDE
\ref{eq:raddiffusion} on a fixed set of \emph{colocation} points while
minimising error on a set of sparse noisy observations. 
Using the surrogate phase space density estimator as a baseline, we
specify the likelihood of the observations.

\emph{Least Squares Support Vector Machines}(LSSVM) have been applied
to calculating approximate solutions to PDEs
\citep{MEHRKANOON2015105}, \citep{MEHRKANOON20122502} as well as
parameter estimation of delay differential equations
\citep{MEHRKANOON2014830}, the approach taken in the aforementioned
research (\citet{MEHRKANOON2014830}) was expressing the parameter
estimation of time delay as an algebraic optimization problem
resulting in closed-form approximation for the time varying parameters
while avoiding iterative simulation of the dynamical system (governed
by the delay differential equations) in the parameter estimation process.

\subsubsection*{Surrogate Phase Space Density Model}

Let $\mathcal{D}={(x^{o}_{i}, y_{i}): i = 1 \cdots n_{o}}$ be a set of
noisy observations of the phase space density $f$, where $x_{i} =
(l_{i}, t_{i})$ are points in the space time domain. We seek a linear
estimator for $f$ of the form $\hat{f}(x) = w^{T}\varphi(x) + b$,
where $\varphi(.): \mathbb{R}^{2} \rightarrow \mathbb{R}^{d}$ is a $d$
dimensional feature map and $b$ is a scalar intercept.

Further let $\mathcal{C} ={(x^{o}_{i}, y_{i}): i = 1 \cdots n_{o}}$ be 
a set of colocation points on which we aim to enforce radial diffusion
dynamics.

We exploit the linearity of the differential operator
$\mathcal{L}_{\theta}$ and note that $\mathcal{L}_{\theta} [\hat{f}(x)]
= w^{T} \mathcal{L}_{\theta}[\varphi(x)]$, yielding an estimator
$\hat{Q}(x) = w^{T}\psi(x)$ where $\psi_{\theta}(x) =
\mathcal{L}_{\theta}[\varphi(x)]$. Calculating $w \in \mathbb{R}^d$
can now be cast as the following constrained $L_2$ regularized 
least squares problem.

\begin{align}\label{eq:surrogate}
   min_{w,e,\epsilon} \ \mathcal{J}(w,e,\epsilon;\theta) &= 
   \frac{1}{2} w^{T}w + \frac{1}{2\gamma_{o}} \sum_{k = 1}^{n_{o}}{e^{2}_{k}} + \frac{1}{2\gamma_{c}} \sum_{k = 1}^{n_{c}}{\epsilon^{2}_{k}} \\
  & s.t \nonumber \\
  y_{i} & = w^{T}\varphi(x^{o}_{i}) + b + e_{i}, \ \ i = 1 \cdots n_{o} \\
  q_{i} & = w^{T}\psi_{\theta}(x^{c}_{i}) + \epsilon_{i}, \ \ i = 1 \cdots n_{c}
\end{align}

It can be seen that system \ref{eq:surrogate} is similar to the
formulation of the LSSVM model, while incorporating the dynamics of
linear PDE systems into its loss function. 

The quantities $\gamma_{o}$ and $\gamma_{c}$ are weights attached to
the errors on observations and colocation points respectively, thus
by smoothly varying them one may assign higher or lower importance for
the surrogate model to fit the observational data and the dynamics of
the physical system.

In order to solve this system one must construct its
\emph{Lagrangian}.

\begin{align*}\label{eq:lag}
      \mathfrak{L}(w,e,\epsilon, \alpha_{1 \cdots k}, \beta_{1 \cdots k}; \theta; \gamma_{o}; \gamma_{c}) &= 
      \frac{1}{2} w^{T}w + \frac{1}{2\gamma_{o}} \sum_{k = 1}^{n_{o}}{e^{2}_{k}} +
      \frac{1}{2\gamma_{c}} \sum_{k = 1}^{n_{c}}{\epsilon^{2}_{k}} \\
      & + \sum_{k = 1}^{n_{o}}{\alpha_{k}(y_{k} - w^{T}\varphi(x^{o}_{k}) + b + e_{k})} \\
      & + \sum_{k = 1}^{n_{c}}{\beta_{k}(q_{j} - w^{T}\psi_{\theta}(x^{c}_{j}) + \epsilon_{j})} 
\end{align*}

Given fixed values for $\gamma_{o}$, $\gamma_{c}$ and PDE parameters
$\theta$, the equation above expresses the Lagrangian of system
\ref{eq:surrogate}. The quantities $\alpha_{1}, \cdots, \alpha_{n_{o}}$ and
$\beta_{1}, \cdots, \beta_{n_{c}}$ are the \emph{Lagrange multipliers}
introduced for equality constraints of the system. Applying the
\emph{Karush-Kuhn-Tucker}(KKT) conditions the solution of the
optimization problem \ref{eq:surrogate} can be expressed in terms of
the Lagrange multipliers $\alpha = (\alpha_{1}, \cdots, \alpha_{n_{o}})$
$\beta = (\beta_{1}, \cdots, \beta_{n_{c}})$.

\begin{equation}\label{eq:solution}
  \begin{bmatrix}
    0 & \mathbf{1}^{T} & \mathbf{0} \\ 
    \mathbf{1} & \Omega + \gamma_{o}I  & \Omega_*\\ 
    \mathbf{0} & \Omega_{*}^{T}  & \Omega_{**} + \gamma_{c}I 
  \end{bmatrix} \begin{bmatrix}
    b\\ 
    \alpha\\ 
    \beta
  \end{bmatrix} = \begin{bmatrix}
    0\\ 
    y\\ 
    q
  \end{bmatrix}
\end{equation}

The components of the symmetric block matrix system on the left hand side of 
\ref{eq:solution} are 
\begin{enumerate}
\item $\Omega \in \mathbb{R}^{n_{o} \times n_{o}}: \omega_{ij} = \varphi(x^{o}_{i})^{T} \varphi(x^{o}_{j})$
\item $\Omega_{**} \in \mathbb{R}^{n_{c} \times n_{c}}: \omega^{**}_{ij} = \psi(x^{c}_{i})^{T} \psi(x^{c}_{j})$
\item $\Omega_{*} \in \mathbb{R}^{n_{o} \times n_{c}}: \omega^{*}_{ij} = \varphi(x^{o}_{i})^{T} \psi(x^{c}_{j})$
\end{enumerate}

The surrogate model can now be used to estimate the phase space density 
at a point $x = (l,t)$ as $\hat{f}(x;\theta) = \sum_{k = 1}^{n_{o}}{\alpha_{k}\varphi(x)^{T}\varphi(x^{o}_{k}) + \sum_{k = 1}^{n_{c}}}{\beta_{k} \varphi(x)^{T} \psi_{\theta}(x^{c}_{k})} + b$

\subsection*{Choice of Basis}

There exist several choices regarding the basis $\varphi(.)$, they are but not limited to 
orthogonal polynomials, Fourier series, radial basis functions etc. 

Radial basis functions were first applied for solution of PDE problems in \cite{KANSA1990147}, 
the authors used colocation with \emph{multiquadric} basis functions for approximating solutions
of boundary value problems.

Radial basis functions have been applied for the mesh-free solutions of Poisson PDE systems 
(\citep{AMINATAEI20082887}, \citep{DUAN200866}, \citep{DUAN2006394} \& \citep{CNM:CNM419}),
as well as the Poisson control problem \citet{Pearson2013}. Further applications of RBFs include 
atmospheric flow \citep{Tillenius2015406}, convection-diffusion \citep{Safdari-Vaighani2015}, and 
Schrödinger's equation (\citep{doi:10.1137/120893975}, \citep{doi:10.1063/1.3637863}). 

For our problem we choose a basis which is a product of a multiquadric radial basis in space and 
an inverse multiquadric basis in time.

\begin{equation}\label{eq:basis}
\varphi_{i}(l,t) = \frac{\sqrt{1+(|l - l_{i}|/\rho_{l})^{2}}}{(1+(|t - t_{i}|/\rho_{t})^{2})^{s/2}}
\end{equation}

The nodes of the basis are placed on a regular rectangular grid and their 
length scales $\rho_l$ and $\rho_t$ are set to the distance between adjacent
node points. The value of the exponent $s$ in equation \ref{eq:basis} should be
a positive value between $0$ and $1$, we observe that setting $s = 0.75$ works well
in practice.

\subsubsection*{Quantifying Observation Likelihood}



\subsection{Inference}

\section{Results}

\subsubsection*{Acknowledgments}

Use unnumbered third level headings for the acknowledgments. All
acknowledgments go at the end of the paper. Do not include
acknowledgments in the anonymized submission, only in the final paper.

\section*{References}

References follow the acknowledgments. Use unnumbered first-level
heading for the references. Any choice of citation style is acceptable
as long as you are consistent. It is permissible to reduce the font
size to \verb+small+ (9 point) when listing the references. {\bf
  Remember that you can go over 8 pages as long as the subsequent ones contain
  \emph{only} cited references.}
\medskip

\small

\bibliography{references}
\end{document}
